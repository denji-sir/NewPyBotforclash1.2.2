# üõ°Ô∏è –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–í—Å–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ —Ç–µ–ø–µ—Ä—å –æ–±–µ—Ä–Ω—É—Ç—ã –≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫, –∫–æ—Ç–æ—Ä—ã–π:

### 1. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
```
‚ùå –û—à–∏–±–∫–∞: register_clan_command

–¢–∏–ø: AttributeError
–ü—Ä–∏—á–∏–Ω–∞: 'NoneType' object has no attribute 'get_clan_by_tag'

üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥—ã –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.
üìã –î–µ—Ç–∞–ª–∏ –≤ –ª–æ–≥–∞—Ö: bot.log
```

### 2. –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –ª–æ–≥
```
==============================================================
‚ùå –û–®–ò–ë–ö–ê –í –ö–û–ú–ê–ù–î–ï: register_clan_command
==============================================================
–¢–∏–ø –æ—à–∏–±–∫–∏: AttributeError
–°–æ–æ–±—â–µ–Ω–∏–µ: 'NoneType' object has no attribute 'get_clan_by_tag'
–§—É–Ω–∫—Ü–∏—è: register_clan_command
–ê—Ä–≥—É–º–µ–Ω—Ç—ã: (<Message...>,)

–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞:
Traceback (most recent call last):
  File "...", line X, in wrapper
    return await func(*args, **kwargs)
  ...
==============================================================
```

### 3. –ù–µ –ª–æ–º–∞–µ—Ç –±–æ—Ç–∞
- –ë–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
- –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –≤–∏–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏

---

## üì¶ –û–±–µ—Ä–Ω—É—Ç—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ö–æ–º–∞–Ω–¥—ã –∫–ª–∞–Ω–æ–≤ (`clan_commands.py`):
- ‚úÖ `/register_clan` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∞–Ω–∞
- ‚úÖ `/clan_list` - —Å–ø–∏—Å–æ–∫ –∫–ª–∞–Ω–æ–≤
- ‚úÖ `/clan_info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∞–Ω–µ
- ‚úÖ `/set_default_clan` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π
- ‚úÖ `/rename_clan` - –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∫–ª–∞–Ω
- ‚úÖ `/clan_members` - —É—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–ª–∞–Ω–∞
- ‚úÖ `/update_clan` - –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

### –ö–æ–º–∞–Ω–¥—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π (`greeting_commands.py`):
- ‚úÖ `/start` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –±–æ—Ç–∞
- ‚úÖ `/commands` - —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
- ‚úÖ `/greeting` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π
- ‚úÖ `/greeting_on` - –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
- ‚úÖ `/greeting_off` - –≤—ã–∫–ª—é—á–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã CoC (`extended_clash_commands.py`):
- ‚úÖ `/war` - —Ç–µ–∫—É—â–∞—è –≤–æ–π–Ω–∞
- ‚úÖ `/raids` - –∫–∞–ø–∏—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–π–¥—ã
- ‚úÖ `/leadership` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∫–ª–∞–Ω–∞
- ‚úÖ `/top_donors` - —Ç–æ–ø –¥–æ–Ω–∞—Ç–µ—Ä–æ–≤

### –ö–æ–º–∞–Ω–¥—ã –ø–∞—Å–ø–æ—Ä—Ç–æ–≤ (`passport_commands.py`):
- ‚úÖ `/create_passport` - —Å–æ–∑–¥–∞—Ç—å –ø–∞—Å–ø–æ—Ä—Ç
- ‚úÖ `/passport` - –ø–æ–∫–∞–∑–∞—Ç—å –ø–∞—Å–ø–æ—Ä—Ç
- ‚úÖ `/edit_passport` - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
- ‚úÖ `/plist` - —Å–ø–∏—Å–æ–∫ –ø–∞—Å–ø–æ—Ä—Ç–æ–≤
- ‚úÖ `/dpassport` - —É–¥–∞–ª–∏—Ç—å –ø–∞—Å–ø–æ—Ä—Ç

---

## üîç –ö–∞–∫ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
```bash
cd /Users/ilya/Desktop/projects/afBot/NewPyBotforclash1.2.2
.venv/bin/python run.py
```

### 2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ Telegram
–ù–∞–ø—Ä–∏–º–µ—Ä: `/register_clan #2PP0JCCL`

### 3. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥
```bash
tail -50 bot.log
```

–í—ã —É–≤–∏–¥–∏—Ç–µ:
- –ö–∞–∫–∞—è –∫–æ–º–∞–Ω–¥–∞ –≤—ã–∑–≤–∞–ª–∞ –æ—à–∏–±–∫—É
- –¢–∏–ø –æ—à–∏–±–∫–∏ (AttributeError, KeyError, etc.)
- –ü–æ–ª–Ω—ã–π traceback
- –ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏

### 4. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```bash
tail -f bot.log | grep "–û–®–ò–ë–ö–ê –í –ö–û–ú–ê–ù–î–ï"
```

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫ –∏ –∏—Ö –∑–Ω–∞—á–µ–Ω–∏–µ

### AttributeError
```
AttributeError: 'NoneType' object has no attribute 'method'
```
**–ü—Ä–∏—á–∏–Ω–∞:** –°–µ—Ä–≤–∏—Å –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ –≤–µ—Ä–Ω—É–ª None  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ `main.py`

### KeyError
```
KeyError: 'clan_tag'
```
**–ü—Ä–∏—á–∏–Ω–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–ª—é—á –≤ —Å–ª–æ–≤–∞—Ä–µ  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ API

### ImportError
```
ImportError: cannot import name 'Service' from 'module'
```
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∞–π–ª  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç–∏ –∏–º–ø–æ—Ä—Ç–∞ –∏ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–æ–≤

### DatabaseError
```
DatabaseError: no such table: registered_clans
```
**–ü—Ä–∏—á–∏–Ω–∞:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø—É—Å–∫ `DatabaseInitializer`

---

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –î–µ–∫–æ—Ä–∞—Ç–æ—Ä `@error_handler`

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `bot/utils/error_handler.py`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
@router.message(Command("my_command"))
@error_handler
async def my_command(message: Message):
    # –í–∞—à –∫–æ–¥
    pass
```

**–§—É–Ω–∫—Ü–∏–∏:**
- –õ–æ–≤–∏—Ç –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- –õ–æ–≥–∏—Ä—É–µ—Ç —Å traceback
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Message –∏ CallbackQuery

### –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

–õ–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è —Å —Ü–≤–µ—Ç–∞–º–∏:
- üî¥ **–ö—Ä–∞—Å–Ω—ã–π** - –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ—à–∏–±–∫–∏
- üü° **–ñ–µ–ª—Ç—ã–π** - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (—Ç–∏–ø, —Å–æ–æ–±—â–µ–Ω–∏–µ)
- üîµ **–°–∏–Ω–∏–π** - —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
1. **–í—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª**, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –ª–æ–≥–∏
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `tail -f bot.log`** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è**

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤** (—á—Ç–æ–±—ã –Ω–µ —Ä–∞–∑—Ä–∞—Å—Ç–∞–ª–∏—Å—å)
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Sentry** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (—É–∂–µ –≤ requirements.txt)
3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
```bash
.venv/bin/python run.py
```

### 2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É —Å –∑–∞–≤–µ–¥–æ–º–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```
/register_clan –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π_—Ç–µ–≥
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ:
- ‚úÖ –ë–æ—Ç –æ—Ç–≤–µ—Ç–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ
- ‚úÖ –í –ª–æ–≥–µ –ø–æ—è–≤–∏–ª–∞—Å—å –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- ‚úÖ –ë–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

---

## üéØ –ò—Ç–æ–≥

**–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–Ω–∞–µ—Ç —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ
2. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –≤–∏–¥–∏—Ç –¥–µ—Ç–∞–ª–∏ –≤ –ª–æ–≥–µ
3. –ë–æ—Ç –Ω–µ –ø–∞–¥–∞–µ—Ç –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

**–í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞—â–∏—â–µ–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –æ—à–∏–±–æ–∫!** ‚úÖ
